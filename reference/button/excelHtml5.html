---
layout: reference_option_detail_layout
title: 以Excel XLSX格式保存表格中的数据(使用Html5)(excelHtml5)
relurl: http://datatables.net/reference/button/excelHtml5
since: Buttons 1.0.0
---
<h1 class="page_title">excelHtml5</h1>
<div style="color: #ac5900;float: right;">起始版本号: {{ page.since }}</div>
<p>以Excel XLSX格式保存表格中的数据(使用Html5)</p>
<p style="color:red">注意：这个需要使用Bottons扩展</p>


<a name="Description"></a>
<h2 data-anchor="Description">说明(Description)</h2>
<p>
    这个按钮可以提供用户把表格数据以Excel方式导出
</p>
<p>
    这个文件只保留原始数据，数据格式，颜色等都不会保留。你也可以使用
    <a href="http://sheetjs.com/" target="_blank">SheetJS</a>库来自定义这个按钮。

</p>
<p>
    这个需要比较新的浏览器支持（不支持IE8和9）。对于老版本的浏览器，{% include href/button/excelFlash.button %}
    使用flash插件提供创建和保存文件的功能。
    {% include href/button/excel.button %}可以基于浏览器的功能，
    自动在和{% include href/button/excelFlash.button %}按钮之间选择。
</p>
<p>
    此外， <a href="https://stuk.github.io/jszip/" target="_blank">JSZip</a>必须在这个页面上可用。
    This MIT licensed library provides the ability to create a ZIP file in the browser,
    which is required to build a valid XLSX file.
</p>
<p>
    <b>注意在Safari上的支持：</b>
    不会下载生成的文件
    <a href="https://bugs.webkit.org/show_bug.cgi?id=102914" target="_blank">参考Webkit bug 102914</a>。
    按钮在Safari上不会显示，建议使用 {% include href/button/excelFlash.button %}按钮类型或者是使用
    {% include href/button/excel.button %}自动选择
</p>


<a name="Options"></a>
<h2 data-anchor="Options">选项(Options)</h2>
<p>这个按钮有以下选项配置:</p>
<table class="parameters buttons dataTable stripe row-border no-footer">
    <thead style="text-align:left">
    <tr>
        <th>名称</th>
        <th>默认</th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
        <td><code>text</code></td>
        <td>EXCEL</td>
    </tr>
    <tr class="odd continuation">
        <td colspan="2">
            按钮上显示的文字，使用 {% include href/option/buttons.buttons.text %} 配置显示的文字内容
            或者 <code>buttons.copy</code>,关于语言的配置参考 {% include href/option/language.Option %}
        </td>
    </tr>
    <tr class="even">
        <td><code>className</code></td>
        <td>buttons-excel buttons-html5</td>
    </tr>
    <tr class="even continuation">
        <td colspan="2">
            按钮的class名称，详情参见 {% include href/option/buttons.buttons.className %}
        </td>
    </tr>
    <tr class="even">
        <td><code>action</code></td>
        <td></td>
    </tr>
    <tr class="even continuation">
        <td colspan="2">
            创建并保存一个Excel文件
        </td>
    </tr>
    <tr class="odd">
        <td><code>exportOptions</code></td>
        <td>{}</td>
    </tr>
    <tr class="odd continuation">
        <td colspan="2">
            选择性的导出数据，包括哪些列，行，排序或者过滤。
            详细参考 {% include href/api/buttons.exportData %} 方法，这里收集所需要的数据
        </td>
    </tr>
    <tr class="odd">
        <td><code>header</code></td>
        <td>true</td>
    </tr>
    <tr class="odd continuation">
        <td colspan="2">
            表头将包含在导出的数据中
        </td>
    </tr>
    <tr class="odd">
        <td><code>footer</code></td>
        <td>false</td>
    </tr>
    <tr class="odd continuation">
        <td colspan="2">
            表脚将包含在导出的数据中
        </td>
    </tr>
    <tr class="odd">
        <td><code>title</code></td>
        <td>*</td>
    </tr>
    <tr class="odd continuation">
        <td colspan="2">
            给创建文件的文件名，*代表替换成系统默认的标题标签。
        </td>
    </tr>
    <tr class="odd">
        <td><code>extension</code></td>
        <td>.xlsx</td>
    </tr>
    <tr class="odd continuation">
        <td colspan="2">
            给创建文件的文件名后缀。
        </td>
    </tr>
    <tr class="odd">
        <td><code>sheetName</code></td>
        <td>Sheet1</td>
    </tr>
    <tr class="odd continuation">
        <td colspan="2">
            给sheet指定名称。 [] \ /: *? :这些字符不允许，如果存在将会被删除
        </td>
    </tr>
    </tbody>
</table>



<a name="Example"></a>
<h2 data-anchor="Example">示例</h2>

<div class="reference_examples">
    <div class="reference_example">
        <div class="title">
            <p>
                Datatables初始化：试用 Html5 Excel 按钮
            </p>
        </div>
 <pre class="brush:js;toolbar:false">$(&#39;#myTable&#39;).DataTable( {
    buttons: [
        &#39;excelHtml5&#39;
    ]
} );</pre>
    </div>
</div>

<div class="reference_examples">
    <div class="reference_example">
        <div class="title">
            <p>
                Datatables初始化：使用 {% include href/button/excel.button %}，让浏览器自动选择
            </p>
        </div>
 <pre class="brush:js;toolbar:false">$(&#39;#myTable&#39;).DataTable( {
    buttons: [
        &#39;excel&#39;
    ]
} );</pre>
    </div>
</div>


<div class="reference_examples">
    <div class="reference_example">
        <div class="title">
            <p>
                Datatables初始化：使用 <code>exportOptions </code>选项配置导当前页数据
            </p>
        </div>
<pre class="brush:js;toolbar:false">$(&#39;#myTable&#39;).DataTable( {
    buttons: [
        {
            extend: &#39;excelHtml5&#39;,
            text: &#39;Save current page&#39;,
            exportOptions: {
                modifier: {
                    page: &#39;current&#39;
                }
            }
        }
    ]
} );</pre>
    </div>
</div>


<div class="clear"></div>
{% include quote.html %}
